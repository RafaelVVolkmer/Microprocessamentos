//Rafael.V.Volkmer (4324); N° 21 - 06/05/2022. Matricula = 20000213

#include "stm32f4xx.h"

uint16_t contador;

const uint16_t mascara = 0b11110000000;

const uint16_t leds[16]=
{
          0b0000000000,   // 0  0000
	  0b0001000000,   // 1  0001
	  0b0010000000,   // 2  0010
	  0b0011000000,   // 3  0011
	  0b0100000000,	  // 4  0100
	  0b0101000000,   // 5  0101
	  0b0110000000,   // 6  0110
	  0b0111000000,   // 7  0111
	  0b1000000000,   // 8  1000
	  0b1001000000,   // 9  1001
	  0b1010000000,   // 10 1010
	  0b1011000000,   // 11 1011
	  0b1100000000,   // 12 1100
	  0b1101000000,   // 13 1101
	  0b1110000000,   // 14 1110
	  0b1111000000    // 15 1111
};

int main(void)
{

  //Habilita clock dos registradores B e C
  RCC->AHB1ENR|=RCC_AHB1ENR_GPIOBEN | RCC_AHB1ENR_GPIOCEN;

  //Zerando os pinos de C
  GPIOC->MODER&=~(GPIO_MODER_MODER9 | GPIO_MODER_MODER8 | GPIO_MODER_MODER7 | GPIO_MODER_MODER6);
  //Saídas PC9 PC8 PC7 PC6
  GPIOC->MODER|=GPIO_MODER_MODER9_0 | GPIO_MODER_MODER8_0 | GPIO_MODER_MODER7_0 | GPIO_MODER_MODER6_0;

  //Entradas PB10 PB9 PB8 PB7
  GPIOB->MODER&=~(GPIO_MODER_MODER10 | GPIO_MODER_MODER9 | GPIO_MODER_MODER8 | GPIO_MODER_MODER7);

  //Zerando PULL-DOWNS
  GPIOB->PUPDR&=~(GPIO_PUPDR_PUPDR10 | GPIO_PUPDR_PUPDR9 | GPIO_PUPDR_PUPDR8 | GPIO_PUPDR_PUPDR7);
  //PB10 PB9 PB8 PB7 são PULL-DOWNS
  GPIOB->PUPDR|=GPIO_PUPDR_PUPDR10_1 | GPIO_PUPDR_PUPDR9_1 | GPIO_PUPDR_PUPDR8_1 | GPIO_PUPDR_PUPDR7_1;

    while (1)
   {
      contador=GPIOB->IDR & mascara;
      contador=contador >> 7;

      GPIOC->ODR=~leds[contador];
   }
}
